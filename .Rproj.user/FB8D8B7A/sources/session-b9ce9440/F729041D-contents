# https://github.com/kiat/R-Examples/blob/master/projects/project-10.xml

# We am interested in testing whether there is a correlation between soccer player’s value and their wage.
# Whether there is a difference in soccer player’s overall performance score among various clubs (FC Barcelona, Juventus, and Real Madrid).
# Also we want to know that whether age has influence on the soccer player’s reaction and 
# if height and weight are factors which will impact soccer player’s balance.
library('tidyverse')
data <- read.csv('https://raw.githubusercontent.com/kiat/R-Examples/master/projects/datasets/project-10.csv')

## Association b/w player's value and wage ?
# SLR
view(data)  
attach(data)
cor(Value_in_M, Wage_in_K) # 0.75
# moderate to strong correlation
plot(Value_in_M, Wage_in_K)

m <- lm(Wage_in_K ~ Value_in_M)
summary(m) # R2=0.568, p-value<0.05
## Linear model is significant, model is better than average

## Check regression assumptions
plot(Value_in_M, residuals(m) , xlab = 'Player\'s Value', ylab = 'Residuals')
# clear obvious pattern emerges as it violates, constant variance assumption

## Is their a difference in football players overall performance among various clubs ?  
# one-way anova using slr
m <- lm(Overall ~ Club)
summary(m)
# as overall model is significant (p-value<alpha)
## we can say as overall performance of player vary by clubs
m <- aov(Overall ~ Club)
summary(m)

## ANNOVA for clubs (FC Barcelona, Juventus, and Real Madrid) only
data %>% filter(Club %in% c('FC Barcelona','Juventus','Real Madrid')) -> data.f
m <- lm(data.f$Overall ~ data.f$Club)
summary(m)
# not significant evidence to suggest overall score differ by clubs (FC Barcelona, Juventus, and Real Madrid) 

data %>% group_by(Club) %>% summarise(mean_score = mean(Overall)) %>% view()

data %>% ggplot(aes(Club, Overall))+geom_boxplot()

## Age has influence on soccer player's reaction ?
# SLR
plot(Age, Reactions)
cor(Age, Reactions) # 0.13
# Weak correlation

m <- lm(Reactions ~ Age)
summary(m) # R2=0.016
# model is better than average
abline(m, col='red')
## Age captures 1.6 % variablilty in player reaction 

plot(Age, residuals(m))
# violates constant variance

## Does height and weight are the factors that impact players balance ?
# MLR - balance = f(height, weight)
m2 <- lm(balance ~ height, weight)
summary(m2) # R2=0.49 , p-value < alpha
# model is significant
## Player's height & weight impacts 50% of the balance