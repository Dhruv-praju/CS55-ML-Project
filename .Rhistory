theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Correlation Heatmap Matrix", x = "Variables", y = "Variables")
mlr.m <- lm(Wage_in_K ~ Value_in_M+Overall+Potential+Reactions, data=data)
summary(mlr.m)
mlr.m <- lm(Wage_in_K ~ Value_in_M + Overall, data = data)
summary(mlr.m)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Potential+Age+Height_in_Inches+Weight_in_lbs+Reactions, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Potential+Age+Height_in_Inches+Reactions, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Potential+Age+Reactions, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Potential+Age, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Age, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength, data = data)
summary(mlr.m2)
length(unique(Club))
length(unique(Nationality))
data %>% group_by(Club) %>% filter(n()>=10) -> tmp.data
data %>% distinct(Club) %>% view()
length(tmp.data)
# get clubs by highest mean wage
data %>% group_by(Club) %>% summarise(Mean_Wage = mean(Wage_in_K)) %>% arrange(desc(Mean_Wage))
options(repr.plot.width = 100, repr.plot.height = 6)
ggplot(data=tmp.data, aes(x=tmp.data$Club, y=tmp.data$Wage_in_K)) +
geom_boxplot()+
labs(x = "Clubs", y = "Wage (in K)", title = 'Distribution of Wage across Clubs')
m <- aov(Wage_in_K ~ Club, data=tmp.data)
summary(m)
pairwise.t.test(tmp.data$Wage_in_K, tmp.data$Club, p.adj='bonferroni')
tukey_result <- TukeyHSD(m)
comparisons <- as.data.frame(tukey_result$Club)
comparisons %>% filter(comparisons$`p adj`<0.05) %>% select('p adj') -> diff.groups
diff.groups
Anova(lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Club, data=tmp.data), type=3)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Club, data=tmp.data)
summary(m)
Anova(lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Club, data=data), type=3)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=tmp.data)
summary(m)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Club, data=tmp.data)
summary(m)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Club, data=data)
summary(m)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=data)
summary(m)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Club, data=data)
summary(m)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=data)
summary(m)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Club, data=data)
summary(m)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Weight_in_lbs+Height_in_Inches+Club, data=data)
summary(m)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Weight_in_lbs+Height_in_Inches+Reactions+Club, data=data)
summary(m)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Weight_in_lbs+Height_in_Inches+Reactions+Age+Club, data=data)
summary(m)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Weight_in_lbs+Height_in_Inches+Age+Club, data=data)
summary(m)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Weight_in_lbs+Reactions+Age+Club, data=data)
summary(m)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Reactions+Age+Club, data=data)
summary(m)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Age+Club, data=data)
summary(m)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=data) #R2=
#m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Club, data=data) #R2=
#m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Age+Club, data=data) #R2=0.9088
summary(m)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=data) #R2=0.875
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Club, data=data) #R2=
#m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Age+Club, data=data) #R2=0.9088
summary(m)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=data) #R2=0.875
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Club, data=data) #R2=90.5
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Age+Club, data=data) #R2=0.9088
summary(m)
m <- aov(Wage_in_K ~ Club, data=data)
summary(m)
pairwise.t.test(Wage_in_K, Club, data=data,p.adj='bonferroni')
tukey_result <- TukeyHSD(m)
comparisons <- as.data.frame(tukey_result$Club)
comparisons %>% filter(comparisons$`p adj`<0.05) %>% select('p adj') -> diff.groups
diff.groups
Anova(lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Club, data=data), type=3)
Anova(lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=data), type=3)
Club with the mean highest salary is Real Madrid followed by FC Barcelona and Manchester City.
# get clubs by highest mean wage
data %>% group_by(Club) %>% arrange(desc(mean(Wage_in_K))) %>% head(20) %>% view()
top.clubs
# get clubs by highest mean wage
data %>% group_by(Club) %>% summarise(Mean_Wage = mean(Wage_in_K)) %>% arrange(desc(mean(Wage_in_K))) %>% head(20) -> top.clubs
top.clubs
# get clubs by highest mean wage
data %>% group_by(Club) %>% summarise(Mean_Wage = mean(Wage_in_K)) %>% arrange(desc(mean(Wage_in_K))) %>% select(Club) %>% head(20) -> top.clubs
top.clubs
data %>% filter(Club %in% top.clubs) %>% view()
c(top.clubs)
data %>% filter(Club %in% c(top.clubs) %>% view()
data %>% filter(Club %in% c(top.clubs) %>% view()
data %>% filter(Club %in% c(top.clubs) %>% view()
c('a','b')
c('a','b')
c(top.clubs)
c(top.clubs)[1]
c(top.clubs)[1]
c(top.clubs)[2]
c(top.clubs)$Club
c(top.clubs)$Club[1]
top.clubs
top.clubs$Club
data %>% filter(Club %in% top.clubs$Club %>% view()
data %>% filter(Club %in% top.clubs$Club) %>% view()
data %>% filter(Club in top.clubs$Club) %>% view()
data %>% filter(Club \%in\% top.clubs$Club) %>% view()
data %>% filter(Club %in% top.clubs$Club) %>% view()
top.clubs
# get clubs by highest mean wage
data %>% group_by(Club) %>% summarise(Mean_Wage = mean(Wage_in_K)) %>% arrange(desc(Mean_Wage)) %>% select(Club) %>% head(20) -> top.clubs
top.clubs
data %>% filter(Club %in% top.clubs$Club) %>% view()
data %>% filter(Club %in% top.clubs$Club) -> top.clubs.data
ggplot(data=top.clubs.data, aes(x=Club, y=Wage_in_K)) +
geom_boxplot()+
labs(x = "Clubs", y = "Wage (in K)", title = 'Distribution of Wage across Clubs')
options(repr.plot.width = 100, repr.plot.height = 6)
ggplot(data=top.clubs.data, aes(x=Club, y=Wage_in_K)) +
geom_boxplot()+
labs(x = "Clubs", y = "Wage (in K)", title = 'Distribution of Wage across Clubs')
comparisons
tukey_result <- TukeyHSD(m)
comparisons <- as.data.frame(tukey_result$Club)
comparisons %>% filter(comparisons$`p adj`<0.05) %>% select('p adj') -> diff.groups
diff.groups
library(emmeans)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=data)
emmeans(m, specs = "group" , contr = "pairwise",  adjust="none")
emmeans(m, specs = "Club" , contr = "pairwise",  adjust="none")
emmeans(m, specs = "Club" , contr = "pairwise",  adjust="none")$contrast
emmeans.result <- emmeans(m, specs = "Club" , contr = "pairwise",  adjust="none")$contrast
as.data.frame(emmeans.result)
as.data.frame(emmeans.result)$df
as.data.frame(emmeans.result)$
```
as.data.frame(emmeans.result)
as.data.frame(emmeans.result)$p.value
emmeans.data <- as.data.frame(emmeans.result)
emmeans.data
length(emmeans.data)
nrow(emmeans.data)
emmeans.data %>% filter(p.value<0.05)
emmeans.data %>% filter(p.value<0.05) %>% view()
emmeans.result <- emmeans(m, specs = "Club" , contr = "pairwise",  adjust="tukey")$contrast
emmeans.data <- as.data.frame(emmeans.result)
emmeans.data %>% filter(p.value<0.05) %>% view()
m <- aov(Wage_in_K ~ Nationality, data=data)
summary(m)
plot(mlr)
plot(mlr.m2)
plot(Wage_in_K, residuals(mlr.m2))
library('tidyverse')
library('reshape2')
library('car')
data <- read.csv('https://raw.githubusercontent.com/kiat/R-Examples/master/projects/datasets/project-10.csv')
data
data$Club[data$Club == "Atl\xe9tico Madrid"] <- "Atletico Madrid"
data$Club[data$Club == "FC Bayern M\xfcnchen"] <- "FC Bayern Munchen"
data$Club[data$Club == "Borussia M\xf6nchengladbach
"] <- "Borussia Monchengladbach"
data$Club[data$Club == "Be?ikta? JK"] <- "Besiktas JK"
data$Club[data$Club == "Fenerbah\xe7e SK"] <- "Fenerbahce SK"
data$Club[data$Club == "Gr\xeamio"] <- "Gremio"
data$Club[data$Club == "AS Saint-\xc9tienne"] <- "AS Saint Etienne"
data$Club[data$Club == "Medipol Ba?ak?ehir FK"] <- "Basaksehir FK"
data$Club[data$Club == "Borussia M\xf6nchengladbach"] <- "Borussia Monchengladbach"
data$Club[data$Club == "1. FC K\xf6ln"] <- "1. FC Koln"
data$Club[data$Club == "Deportivo Alav\xe9s"] <- "Deportivo Alaves"
data$Club[data$Club == "Guangzhou R&F; FC"] <- "Guangzhou City F.C."
data$Club[data$Club == "Atl\xe9tico Mineiro"] <- "Atletico Mineiro"
data <- data[data$Wage_in_K!=0,]
names(data) <- make.names(names(data))
glimpse(data)
attach(data)
view(data)
plot( Value_in_M, Wage_in_K, xlab = 'Value', ylab = 'Wage', main = 'Relation between wage and value of the player')
cor(Value_in_M, Wage_in_K)
# SLR
m <- lm(Wage_in_K ~ Value_in_M)
# plot SLR
plot( Value_in_M, Wage_in_K, xlab = 'Value', ylab = 'Wage', main = 'Relation between wage and value of player')
abline(m, col='red')
# SLR summary
summary(m)
# CI of coefficients
upper.c1 <- coef(m)[1]+qt(0.95,500-2)*4.3343
lower.c1 <- coef(m)[1]-qt(0.95,500-2)*4.3343
upper.value <- coef(m)[2]+qt(0.95,500-2)*0.1367
lower.value <- coef(m)[2]-qt(0.95,500-2)*0.1367
plot(Value_in_M, residuals(m), xlab = 'Value (X)', ylab = 'Residual')
abline(h=0)
plot(Wage_in_K, residuals(m), xlab = 'Wage (Y)', ylab = 'Residual')
abline(h=0)
hist(residuals(m))
new.data <- data[Wage_in_K!=0,]
cor(new.data$Value_in_M, log(new.data$Wage_in_K))
m <- lm(log(new.data$Wage_in_K)~new.data$Value_in_M)
summary(m)
cor(sqrt(data$Wage_in_K), Value_in_M)
m <- lm(sqrt(data$Wage_in_K)~Value_in_M)
summary(m)
cor(Wage_in_K, Value_in_M**2)
m <- lm(Wage_in_K~Value_in_M**2)
summary(m)
new.data <- data[Value_in_M!=0,]
cor(new.data$Wage_in_K, log(new.data$Value_in_M))
m <- lm(new.data$Wage_in_K~log(new.data$Value_in_M))
summary(m)
m <- lm(Wage_in_K ~ Value_in_M + I(Value_in_M**2))
summary(m)
numeric_cols <- data %>% select_if(is.numeric)
cor_matrix <- cor(numeric_cols)
cor_matrix_melted <- melt(cor_matrix)
ggplot(cor_matrix_melted, aes(Var1, Var2, fill = value, label = round(value, 2))) +
geom_tile(color = "white") +
geom_text(size = 3, color = "black") +  # Add text labels for correlation coefficients
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1, 1),
space = "Lab", name = "Correlation") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Correlation Heatmap Matrix", x = "Variables", y = "Variables")
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Potential+Age+Height_in_Inches+Weight_in_lbs+Reactions, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Potential+Age+Height_in_Inches+Reactions, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Potential+Age+Reactions, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Potential+Age, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Age, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength, data = data)
summary(mlr.m2)
plot(Wage_in_K, residuals(mlr.m2))
length(unique(Club))
length(unique(Nationality))
# get top 20 clubs by highest mean wage
data %>% group_by(Club) %>% summarise(Mean_Wage = mean(Wage_in_K)) %>% arrange(desc(Mean_Wage)) %>% select(Club) %>% head(20) -> top.clubs
data %>% filter(Club %in% top.clubs$Club) -> top.clubs.data
options(repr.plot.width = 100, repr.plot.height = 6)
ggplot(data=top.clubs.data, aes(x=Club, y=Wage_in_K)) +
geom_boxplot()+
labs(x = "Clubs", y = "Wage (in K)", title = 'Distribution of Wage across Clubs')
m <- aov(Wage_in_K ~ Club, data=data)
summary(m)
# pairwise t-test using bonferroni method
pairwise.t.test(Wage_in_K, Club, data=data,p.adj='bonferroni')
# tukeys pair wise t-test
tukey_result <- TukeyHSD(m)
# convert to dataframe
comparisons <- as.data.frame(tukey_result$Club)
# filter pairs whose p-value<0.05
comparisons %>% filter(comparisons$`p adj`<0.05) %>% select('p adj') -> diff.groups
diff.groups
Anova(lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=data), type=3)
library(emmeans)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=data)
emmeans.result <- emmeans(m, specs = "Club" , contr = "pairwise",  adjust="tukey")$contrast
emmeans.data <- as.data.frame(emmeans.result)
emmeans.data %>% filter(p.value<0.05) %>% view()
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=data) #R2=0.875
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Club, data=data) #R2=0.905
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Age+Club, data=data) #R2=0.909
summary(m)
m <- aov(Wage_in_K ~ Nationality, data=data)
summary(m)
glimpse(data)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=data) #R2=0.875
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Club, data=data) #R2=0.905
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Age+Club, data=data) #R2=0.909
summary(m)
plot(mlr.m)
knitr::kable(data)
data
install.packages("tinytex")
tinytex::install_tinytex()
install.packages("rmarkdown")
install.packages("rmarkdown")
library('tidyverse')
library('reshape2')
library('car')
data <- read.csv('https://raw.githubusercontent.com/kiat/R-Examples/master/projects/datasets/project-10.csv')
data
glimpse(data)
data$Club[data$Club == "Atl\xe9tico Madrid"] <- "Atletico Madrid"
data$Club[data$Club == "FC Bayern M\xfcnchen"] <- "FC Bayern Munchen"
data$Club[data$Club == "Borussia M\xf6nchengladbach
"] <- "Borussia Monchengladbach"
data$Club[data$Club == "Be?ikta? JK"] <- "Besiktas JK"
data$Club[data$Club == "Fenerbah\xe7e SK"] <- "Fenerbahce SK"
data$Club[data$Club == "Gr\xeamio"] <- "Gremio"
data$Club[data$Club == "AS Saint-\xc9tienne"] <- "AS Saint Etienne"
data$Club[data$Club == "Medipol Ba?ak?ehir FK"] <- "Basaksehir FK"
data$Club[data$Club == "Borussia M\xf6nchengladbach"] <- "Borussia Monchengladbach"
data$Club[data$Club == "1. FC K\xf6ln"] <- "1. FC Koln"
data$Club[data$Club == "Deportivo Alav\xe9s"] <- "Deportivo Alaves"
data$Club[data$Club == "Guangzhou R&F; FC"] <- "Guangzhou City F.C."
data$Club[data$Club == "Atl\xe9tico Mineiro"] <- "Atletico Mineiro"
data <- data[data$Wage_in_K!=0,]
names(data) <- make.names(names(data))
attach(data)
view(data)
plot( Value_in_M, Wage_in_K, xlab = 'Value', ylab = 'Wage', main = 'Relation between wage and value of the player')
cor(Value_in_M, Wage_in_K)
# SLR
m <- lm(Wage_in_K ~ Value_in_M)
# plot SLR
plot( Value_in_M, Wage_in_K, xlab = 'Value', ylab = 'Wage', main = 'Relation between wage and value of player')
abline(m, col='red')
# SLR summary
summary(m)
# CI of coefficients
upper.c1 <- coef(m)[1]+qt(0.95,500-2)*4.3343
lower.c1 <- coef(m)[1]-qt(0.95,500-2)*4.3343
upper.value <- coef(m)[2]+qt(0.95,500-2)*0.1367
lower.value <- coef(m)[2]-qt(0.95,500-2)*0.1367
plot(Value_in_M, residuals(m), xlab = 'Value (X)', ylab = 'Residual')
abline(h=0)
plot(Wage_in_K, residuals(m), xlab = 'Wage (Y)', ylab = 'Residual')
abline(h=0)
hist(residuals(m))
new.data <- data[Wage_in_K!=0,]
cor(new.data$Value_in_M, log(new.data$Wage_in_K))
m <- lm(log(new.data$Wage_in_K)~new.data$Value_in_M)
summary(m)
cor(sqrt(data$Wage_in_K), Value_in_M)
m <- lm(sqrt(data$Wage_in_K)~Value_in_M)
summary(m)
cor(Wage_in_K, Value_in_M**2)
m <- lm(Wage_in_K~Value_in_M**2)
summary(m)
new.data <- data[Value_in_M!=0,]
cor(new.data$Wage_in_K, log(new.data$Value_in_M))
m <- lm(new.data$Wage_in_K~log(new.data$Value_in_M))
summary(m)
m <- lm(Wage_in_K ~ Value_in_M + I(Value_in_M**2))
summary(m)
numeric_cols <- data %>% select_if(is.numeric)
cor_matrix <- cor(numeric_cols)
cor_matrix_melted <- melt(cor_matrix)
ggplot(cor_matrix_melted, aes(Var1, Var2, fill = value, label = round(value, 2))) +
geom_tile(color = "white") +
geom_text(size = 3, color = "black") +  # Add text labels for correlation coefficients
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1, 1),
space = "Lab", name = "Correlation") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Correlation Heatmap Matrix", x = "Variables", y = "Variables")
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Potential+Age+Height_in_Inches+Weight_in_lbs+Reactions, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Potential+Age+Height_in_Inches+Reactions, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Potential+Age+Reactions, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Potential+Age, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Age, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength, data = data)
summary(mlr.m2)
plot(Wage_in_K, residuals(mlr.m2))
length(unique(Club))
length(unique(Nationality))
# get top 20 clubs by highest mean wage
data %>% group_by(Club) %>% summarise(Mean_Wage = mean(Wage_in_K)) %>% arrange(desc(Mean_Wage)) %>% select(Club) %>% head(20) -> top.clubs
data %>% filter(Club %in% top.clubs$Club) -> top.clubs.data
options(repr.plot.width = 100, repr.plot.height = 6)
ggplot(data=top.clubs.data, aes(x=Club, y=Wage_in_K)) +
geom_boxplot()+
labs(x = "Clubs", y = "Wage (in K)", title = 'Distribution of Wage across Clubs')
m <- aov(Wage_in_K ~ Club, data=data)
summary(m)
# pairwise t-test using bonferroni method
pairwise.t.test(Wage_in_K, Club, data=data,p.adj='bonferroni')
# tukeys pair wise t-test
tukey_result <- TukeyHSD(m)
# convert to dataframe
comparisons <- as.data.frame(tukey_result$Club)
# filter pairs whose p-value<0.05
comparisons %>% filter(comparisons$`p adj`<0.05) %>% select('p adj') -> diff.groups
diff.groups
Anova(lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=data), type=3)
library(emmeans)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=data)
emmeans.result <- emmeans(m, specs = "Club" , contr = "pairwise",  adjust="tukey")$contrast
emmeans.data <- as.data.frame(emmeans.result)
emmeans.data %>% filter(p.value<0.05) %>% view()
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=data) #R2=0.875
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Club, data=data) #R2=0.905
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Age+Club, data=data) #R2=0.909
summary(m)
m <- aov(Wage_in_K ~ Nationality, data=data)
summary(m)
plot(mlr.m)
print('d')
install.packages("rmarkdown")
rmarkdown::render("Final Project.Rmd", output_format = "pdf_document")
library('tidyverse')
library('reshape2')
library('car')
data <- read.csv('https://raw.githubusercontent.com/kiat/R-Examples/master/projects/datasets/project-10.csv')
data
glimpse(data)
data$Club[data$Club == "Atl\xe9tico Madrid"] <- "Atletico Madrid"
data$Club[data$Club == "FC Bayern M\xfcnchen"] <- "FC Bayern Munchen"
data$Club[data$Club == "Borussia M\xf6nchengladbach
"] <- "Borussia Monchengladbach"
data$Club[data$Club == "Be?ikta? JK"] <- "Besiktas JK"
data$Club[data$Club == "Fenerbah\xe7e SK"] <- "Fenerbahce SK"
data$Club[data$Club == "Gr\xeamio"] <- "Gremio"
data$Club[data$Club == "AS Saint-\xc9tienne"] <- "AS Saint Etienne"
data$Club[data$Club == "Medipol Ba?ak?ehir FK"] <- "Basaksehir FK"
data$Club[data$Club == "Borussia M\xf6nchengladbach"] <- "Borussia Monchengladbach"
data$Club[data$Club == "1. FC K\xf6ln"] <- "1. FC Koln"
data$Club[data$Club == "Deportivo Alav\xe9s"] <- "Deportivo Alaves"
data$Club[data$Club == "Guangzhou R&F; FC"] <- "Guangzhou City F.C."
data$Club[data$Club == "Atl\xe9tico Mineiro"] <- "Atletico Mineiro"
data <- data[data$Wage_in_K!=0,]
names(data) <- make.names(names(data))
attach(data)
view(data)
plot( Value_in_M, Wage_in_K, xlab = 'Value', ylab = 'Wage', main = 'Relation between wage and value of the player')
cor(Value_in_M, Wage_in_K)
# SLR
m <- lm(Wage_in_K ~ Value_in_M)
# plot SLR
plot( Value_in_M, Wage_in_K, xlab = 'Value', ylab = 'Wage', main = 'Relation between wage and value of player')
abline(m, col='red')
# SLR summary
summary(m)
# CI of coefficients
upper.c1 <- coef(m)[1]+qt(0.95,500-2)*4.3343
lower.c1 <- coef(m)[1]-qt(0.95,500-2)*4.3343
upper.value <- coef(m)[2]+qt(0.95,500-2)*0.1367
lower.value <- coef(m)[2]-qt(0.95,500-2)*0.1367
plot(Value_in_M, residuals(m), xlab = 'Value (X)', ylab = 'Residual')
abline(h=0)
plot(Wage_in_K, residuals(m), xlab = 'Wage (Y)', ylab = 'Residual')
abline(h=0)
hist(residuals(m))
new.data <- data[Wage_in_K!=0,]
cor(new.data$Value_in_M, log(new.data$Wage_in_K))
m <- lm(log(new.data$Wage_in_K)~new.data$Value_in_M)
summary(m)
cor(sqrt(data$Wage_in_K), Value_in_M)
m <- lm(sqrt(data$Wage_in_K)~Value_in_M)
summary(m)
cor(Wage_in_K, Value_in_M**2)
m <- lm(Wage_in_K~Value_in_M**2)
summary(m)
new.data <- data[Value_in_M!=0,]
cor(new.data$Wage_in_K, log(new.data$Value_in_M))
m <- lm(new.data$Wage_in_K~log(new.data$Value_in_M))
summary(m)
m <- lm(Wage_in_K ~ Value_in_M + I(Value_in_M**2))
summary(m)
numeric_cols <- data %>% select_if(is.numeric)
cor_matrix <- cor(numeric_cols)
cor_matrix_melted <- melt(cor_matrix)
ggplot(cor_matrix_melted, aes(Var1, Var2, fill = value, label = round(value, 2))) +
geom_tile(color = "white") +
geom_text(size = 3, color = "black") +  # Add text labels for correlation coefficients
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1, 1),
space = "Lab", name = "Correlation") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Correlation Heatmap Matrix", x = "Variables", y = "Variables")
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Potential+Age+Height_in_Inches+Weight_in_lbs+Reactions, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Potential+Age+Height_in_Inches+Reactions, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Potential+Age+Reactions, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Potential+Age, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength+Age, data = data)
mlr.m2 <- lm(Wage_in_K ~ Value_in_M+Overall+Balance+Strength, data = data)
summary(mlr.m2)
plot(Wage_in_K, residuals(mlr.m2))
length(unique(Club))
length(unique(Nationality))
# get top 20 clubs by highest mean wage
data %>% group_by(Club) %>% summarise(Mean_Wage = mean(Wage_in_K)) %>% arrange(desc(Mean_Wage)) %>% select(Club) %>% head(20) -> top.clubs
data %>% filter(Club %in% top.clubs$Club) -> top.clubs.data
options(repr.plot.width = 100, repr.plot.height = 6)
ggplot(data=top.clubs.data, aes(x=Club, y=Wage_in_K)) +
geom_boxplot()+
labs(x = "Clubs", y = "Wage (in K)", title = 'Distribution of Wage across Clubs')
m <- aov(Wage_in_K ~ Club, data=data)
summary(m)
# pairwise t-test using bonferroni method
pairwise.t.test(Wage_in_K, Club, data=data,p.adj='bonferroni')
# tukeys pair wise t-test
tukey_result <- TukeyHSD(m)
# convert to dataframe
comparisons <- as.data.frame(tukey_result$Club)
# filter pairs whose p-value<0.05
comparisons %>% filter(comparisons$`p adj`<0.05) %>% select('p adj') -> diff.groups
diff.groups
Anova(lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=data), type=3)
library(emmeans)
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=data)
emmeans.result <- emmeans(m, specs = "Club" , contr = "pairwise",  adjust="tukey")$contrast
emmeans.data <- as.data.frame(emmeans.result)
emmeans.data %>% filter(p.value<0.05) %>% view()
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Club, data=data) #R2=0.875
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Club, data=data) #R2=0.905
m <- lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Age+Club, data=data) #R2=0.909
summary(m)
m <- aov(Wage_in_K ~ Nationality, data=data)
summary(m)
mlr.final = lm(Wage_in_K ~ Overall+Value_in_M+Balance+Strength+Potential+Age+Club, data=data)
plot(mlr.final)
rmarkdown::render("Final Project.Rmd", output_format = "pdf_document")
write.csv(data,'clean_data.csv')
